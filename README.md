# どんどんぱっゲーム

リズムに合わせてマットを踏む体感型ゲームです。

## セットアップ

### 1. 依存関係のインストール

```bash
npm install
```

### 2. MLX-LMサーバーの起動

MLX-LMサーバーが起動していることを確認してください（ポート5001）。

### 3. コメントの生成

初回実行時、またはコメントを更新したい場合は以下のコマンドを実行します：

```bash
npm run generate-comments
```

これにより、加点時・減点時のコメントが各50個ずつ生成され、`game-comments.json`に保存されます。

### 4. ゲームサーバーの起動

```bash
npm start
```

ブラウザで http://localhost:3000 にアクセスしてゲームを開始できます。

## 機能

- **リズムゲーム**: 「どん」「どん」「ぱっ」のリズムに合わせてマットを踏む
- **スコアシステム**: 正解で+100点、ミスで-50点
- **AIコメント**: MLX-LMによるリアルタイムコメントと評価
- **MIDI送信**: ゲーム中のタイミングでMIDI信号を送信
- **物理マット対応**: M5Stack AtomS3経由で物理マットからの入力に対応

## 操作方法

- **物理マット**: 手前のマットで「ぱっ」のタイミング、奥のマットでゲーム開始
- **キーボード**: 1キーで「ぱっ」のタイミング、2キーでゲーム開始

## 注意事項

- `game-comments.json`は自動生成されるファイルのため、Gitにはコミットされません
- コメント生成にはMLX-LMサーバーが必要です
- MIDIデバイスが接続されていない場合、MIDI機能は自動的に無効化されます